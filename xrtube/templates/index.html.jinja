<!DOCTYPE html>
<html>
    <head>
        <title>{{title}}</title>
        <meta charset="utf-8">
        <meta name="viewport"
              content="width=device-width, initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" href="/style.css">
        <link rel="stylesheet"
            href="{{url_for("static", path="/video-js.min.css")}}">

        <script src="{{url_for("static", path="/htmx.min.js")}}"></script>
        <script src="{{url_for("static", path="/video.min.js")}}"></script>
    </head>
    <body>
        <form
            hx-get="/results"
            hx-select="#results"
            hx-target="#results"
            hx-push-url=true
        >
            <input
                type=search
                placeholder="Search"
                autocomplete=true
                autofocus=true
                name=search_query
            >
        </form>

        <div id=player-holder>
            {% if video %}
                {% include "player.html.jinja" %}
            {% endif %}
        </div>

        <div id=results>
            {% for entry in results.entries %}
                <a
                    href="{{local_url(entry.url)}}"
                    hx-get="{{local_url(entry.url)}}"
                    hx-select=#player-holder
                    hx-target=#player-holder
                    hx-push-url=true
                >
                    <img src="{{entry.thumb_for(160).fixed_url}}">
                    <p>{{entry.title}}</p>
                </a>
            {% endfor %}

            {% if next_page %}
                <div
                    class=lazy-loader
                    hx-get="{{next_page}}"
                    hx-trigger="intersect once"
                    hx-select="#results > *"
                    hx-target=#results
                    hx-swap=beforeend
                ></div>
            {% endif %}
        </div>
    </body>
</html>
